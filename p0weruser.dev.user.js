// ==UserScript==
// @name         p0weruser - Rel0aded [Dev]
// @namespace    https://github.com/Scarwolf/p0weruser/
// @version      2.4.2-dev-1666513562209
// @author       PoTTii - Created by Florian Maak
// @description  A modularized userScript for pr0gramm.com - Developed by FlorianMaak, Modified by Scarwolf
// @license      GPL-3.0; http://www.gnu.org/licenses/gpl-3.0.txt
// @icon         https://pr0gramm.com/media/pr0gramm-favicon.png
// @homepage     https://github.com/Scarwolf/p0weruser
// @homepageURL  https://github.com/Scarwolf/p0weruser
// @source       https://github.com/Scarwolf/p0weruser
// @supportURL   https://github.com/Scarwolf/p0weruser/issues
// @downloadURL  https://scarwolf.github.io/p0weruser/p0weruser.dev.user.js
// @updateURL    https://scarwolf.github.io/p0weruser/p0weruser.dev.user.js
// @include      /^https?://pr0gramm.com/.*$/
// @require      https://code.jquery.com/ui/1.13.1/jquery-ui.min.js
// @require      https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js
// @require      https://cdn.jsdelivr.net/npm/tesseract.js@2.1.5/dist/tesseract.min.js
// @resource     customCSS  https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css
// @connect      rep0st.rene8888.at
// @connect      github.com
// @connect      raw.githubusercontent.com
// @connect      pr0gramm.com
// @connect      pr0p0ll.com
// @grant        GM_info
// @grant        GM_notification
// @grant        GM_xmlhttpRequest
// @grant        window.focus
// @run-at       document-end
// ==/UserScript==

(e=>{const t=document.createElement("style");t.dataset.source="vite-plugin-monkey",t.innerText=e,document.head.appendChild(t)})(`#addon-list label{margin-bottom:10px}#addon-list label span{display:block;color:#888}#module-settings{background-color:#303035;padding:10px 10px 10px 20px}#module-settings h3:not(:first-child){margin-top:60px}#settings_hint{background-color:var(--theme-main-color);text-align:center;position:absolute;top:52px;width:100%;padding:10px}.settings-tab .actions a:not(:first-of-type){margin-left:10px}.settings-tab .text-type .description{display:block;color:#888;margin-bottom:10px}.settings-tab .text-type input{margin-bottom:20px;width:80%}.settings-tab #versioninfo dt{float:left;font-weight:700;margin-right:.5em;width:130px}.settings-tab #versioninfo dt:after{content:": "}.settings-tab #versioninfo dd:after{clear:left;content:" ";display:block}.settings-tab #versioninfo dd:empty:before{content:"..."}.settings-tab #versioninfo dd a{font-size:10px;margin-left:5px}.settings-tab #versioninfo dd a:after{content:")"}.settings-tab #versioninfo dd a:before{content:"("}
`);

var Ie=Object.defineProperty;var Ne=(k,b,w)=>b in k?Ie(k,b,{enumerable:!0,configurable:!0,writable:!0,value:w}):k[b]=w;var o=(k,b,w)=>(Ne(k,typeof b!="symbol"?b+"":b,w),w);(function(k,b){var P,D;"use strict";const w=l=>l&&typeof l=="object"&&"default"in l?l:{default:l},W=w(k),O=w(b),u=l=>{const e=document.createElement("style");e.innerText=l,document.head.appendChild(e)};class x{static waitForElement(e){return new Promise((t,n)=>{let i=[],s=()=>{i[0]?t(i):(i=document.querySelectorAll(e),setTimeout(()=>{s()},10))};s()})}static escapeHtml(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}static changeLocation(e){p.location=e,window.history.pushState({},"pr0gramm.com",e)}static getUrlParams(e){let t={};e=e.split("?");let n=e[1].split("&");for(let i=0;i<n.length;i++){let s=n[i].split("=");t[s[0]]=s[1]}return{url:e[0],params:t}}static isElementInViewport(e){typeof jQuery=="function"&&e instanceof jQuery&&(e=e[0]);let t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}static getUrlFromParams(e,t){let n=e+"?";for(let i in t)t.hasOwnProperty(i)&&(n!==e+"?"&&(n+="&"),n+=i+"="+t[i]);return n}static insertAfter(e,t){t.parentNode.insertBefore(e,t.nextSibling)}static addPrototypes(){String.prototype.replaceArray=function(e,t){let n=this;for(let i=0;i<e.length;i++)n=n.replace(e[i],t[i]);return n}}static addVideoConstants(){p.View.Stream.Item.TARGET={NOTHING:0,SEEK_CONTROLS:1,VOLUME_CONTROLS:2}}}class H{constructor(){this.settingsLoaded=new Event("settingsLoaded"),this.commentsLoaded=new Event("commentsLoaded"),this.locationChange=new Event("locationChange"),this.beforeLocationChange=new Event("beforeLocationChange"),this.userSync=new Event("userSync"),this.locationPattern=new RegExp("\\d+$"),this.addEvents()}addEvents(){let e=this;(function(t){p.View.Settings.prototype.render=function(n){t.call(this,n),window.dispatchEvent(e.settingsLoaded)}})(p.View.Settings.prototype.render),function(t){p.navigateTo=function(n,i){e.beforeLocationChange.mode=i,window.dispatchEvent(e.beforeLocationChange),t.call(this,n,i),e.locationChange.mode=i,e.locationChange.isPost=e.locationPattern.test(n),window.dispatchEvent(e.locationChange)}}(p.navigateTo),window.onpopstate=function(t){e.locationChange.mode=0,e.locationChange.isPost=e.locationPattern.test(t.currentTarget.location.pathname),window.dispatchEvent(e.locationChange)},function(t){p.View.Stream.Comments.prototype.render=function(){t.call(this),e.commentsLoaded.data=this.$container,window.dispatchEvent(e.commentsLoaded)}}(p.View.Stream.Comments.prototype.render),function(t){p.User.prototype.syncCallback=function(n){e.userSync.data=n,t.call(this,n),window.dispatchEvent(e.userSync)}}(p.User.prototype.syncCallback)}}const Fe="",q=`<div class="form-section settings-tab">
    <h2>Addon Einstellungen</h2>
    <h3>Aktionen</h3>
    <div class="form-row actions">
        <a class="action clear-settings-button">Einstellungen zur\xFCcksetzen</a>
    </div>

    <h3>Verf\xFCgbare Module</h3>
    <div id="addon-list"></div>

    <div class="form-row">
        <input type="submit" id="save-addon-settings" value="Einstellungen speichern" class="confirm settings-save">
    </div>

    <h3>Versionsinformationen</h3>
    <div id="versioninfo">
        <dl>
            <dt>Installiert</dt>
            <dd id="installed_version"></dd>
            <dt>Latest Release</dt>
            <dd id="release_version"></dd>
        </dl>
    </div>
</div>
`;var y=(P=document.__monkeyWindow)!=null?P:window;y.GM,y.unsafeWindow=(D=y.unsafeWindow)!=null?D:window,y.unsafeWindow;var K=y.GM_info;y.GM_cookie;var A=(...l)=>y.GM_notification(...l),T=(...l)=>y.GM_xmlhttpRequest(...l);class c{constructor(e,t){o(this,"modules");o(this,"activatedModules");o(this,"tabs",{});o(this,"tabContent",{});o(this,"hintIsShown",!1);this.modules=e,this.activatedModules=t,this.addListeners()}static clearSettings(){window.localStorage.setItem("activated_modules","[]"),p.reload()}static saveSettings(e){let t=[],n=e.querySelectorAll(":checked");for(const i of n)t.push(i.dataset.module);window.localStorage.setItem("activated_modules",JSON.stringify(t)),c.saveModuleSettings(),window.location.href="/settings/site"}static saveModuleSettings(){const e=document.querySelectorAll("#module-settings input");for(const t of e)switch(t.type){case"text":c.set(t.id,t.value);break;case"number":c.set(t.id,String(Number(t.value)||1));break;case"checkbox":c.set(t.id,String(t.checked));break}}static addHint(){if(!document.getElementById("settings_hint")){const e=document.getElementById("head-content");if(e===null)throw new Error("Header could not be found");const t=document.createElement("div");return t.id="settings_hint",t.innerText="Bitte \xF6ffne die Einstellungen um p0weruser zu konfigurieren!",e.appendChild(t),!0}}static getVersion(){let e="https://github.com/Scarwolf/p0weruser/raw/master/package.json";return new Promise((t,n)=>{T({url:e,method:"GET",headers:{"cache-control":"no-cache","Upgrade-Insecure-Requests":"1"},onload:i=>{const s=i.responseText.match('"version":.*"(.*)"');t(s!==null?s[1]:"Not available!")},onerror:i=>{n(i)}})})}addListeners(){window.addEventListener("settingsLoaded",()=>{console.log("Settings loaded"),this.addSettingsTab()})}addSettingsTab(){this.tabContent=document.querySelectorAll(".pane.form-page")[0],this.tabs=document.getElementsByClassName("tab-bar")[0];let e=document.createElement("a");e.innerText="p0weruser",e.href="/settings/addons",e.addEventListener("click",t=>{t.preventDefault(),this.toggleSettingsTab(e)}),this.tabs.appendChild(e)}toggleSettingsTab(e){x.changeLocation("/settings/addons");let t=document.createElement("div");this.modules,this.tabContent.innerHTML=q;let n=this.tabContent.querySelectorAll("#addon-list")[0];this.modules.forEach(a=>{const r=this.activatedModules.some(m=>m.id===a.id);t.innerHTML+=`
                <input type="checkbox" 
                       class="box-from-label"
                       name="${a.id}" 
                       id="${a.id}" 
                       data-module="${a.id}" ${r?' checked="checked"':""}>
                <label for="${a.id}">
                    ${a.name}
                    <span>${a.description}</span>
                </label>`}),n.appendChild(t),this.tabs.getElementsByClassName("active")[0].classList.remove("active"),e.classList.add("active"),this.addModuleSettings(t),this.loadVersionInfo(),this.tabContent.getElementsByClassName("clear-settings-button")[0].addEventListener("click",()=>{window.confirm("Einstellungen wirklich zur\xFCcksetzen?")&&c.clearSettings()}),this.tabContent.querySelectorAll("#save-addon-settings")[0].addEventListener("click",()=>{c.saveSettings(t)})}addModuleSettings(e){this.modules;const t=this.activatedModules;let n=document.createElement("div");n.id="module-settings";for(const i of t){let s=i;if(typeof s=="object"&&typeof s.getSettings=="function"){const a=s.getSettings();let r=document.createElement("h3");r.innerText=s.name,n.append(r);for(const m of a){const d=`${s.id}.settings.${m.id}`,g=c.get(d);let h=document.createElement("div");switch(h.className="box-from-label",m.type){case"number":const L=g===!0?1:g;h.innerHTML=`<div class="text-type"><span class="title">${m.title}</span><span class="description">${m.description}</span><input id="${d}" type="number" value="${L}" /></div>`;break;case"text":const f=x.escapeHtml(g===!0?"":g);h.innerHTML=`<div class="text-type"><span class="title">${m.title}</span><span class="description">${m.description}</span><input id="${d}" type="text" value="${f}" /></div>`;break;default:h.innerHTML=`<input id="${d}" type="${m.type?m.type:"checkbox"}" class="box-from-label" ${g?"checked":""} /><label for="${d}">${m.title}<span>${m.description}</span></label>`;break}r.after(h)}}}e.after(n)}static get(e,t=!0){const n=window.localStorage.getItem(e);return n===null?(c.set(e,String(t)),t):n==="true"||n==="false"?n==="true":n}static set(e,t){return window.localStorage.setItem(e,t),t}loadVersionInfo(){const e={installed:document.getElementById("installed_version"),release:document.getElementById("release_version")};e.installed.innerText=K.script.version,c.getVersion().then(t=>{e.release.innerText=t})}}const G=`.comments:not(.no-colors) .comment+.comment-box{padding-left:0}.comments:not(.no-colors) .comment+.comment-box>div>.comment{border-left-style:solid;border-color:#ee4d2e;padding-left:5px}.comments:not(.no-colors) .comment+.comment-box>div>.comment>.comment-vote{left:10px}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#1db992}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#bfbc06}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#008fff}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#ff0082}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#ee2e2e}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#f7ea19}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#19f7a6}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#ee4d2e}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#8c19f7}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#19f743}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#b9791d}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#1db9b3}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#fff}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#1db992}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#bfbc06}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#008fff}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#ff0082}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#ee2e2e}.comments:not(.no-colors) .comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment+.comment-box>div>.comment{border-color:#f7ea19}.comments:not(.no-colors) .comment.own-comment{color:#ee4d2e}
`;class F{constructor(){o(this,"id","AdvancedComments");o(this,"name","Erweiterte Kommentare");o(this,"description","Erweitert die Kommentare um Farben und weitere Funktionen");o(this,"isDisplayColorsEnabled",c.get("AdvancedComments.settings.display_colors"))}static handleMouseover(e,t){const n=$(`#${e} .comment-content`);t.title=n[0].innerText}async load(){this.prepareComments(),u(G)}getSettings(){return[{id:"display_colors",title:"Kommentarfarben",description:"F\xE4rbe Kommentarebenen ein!",type:"checkbox"}]}prepareComments(){window.addEventListener("commentsLoaded",()=>{this.isDisplayColorsEnabled||$(".comments").addClass("no-colors");const e=$(".comments .comment-box .comment");for(const t of e.toArray()){const n=$(t),i=$(n.parents(".comment-box")[0]).prev(".comment"),s=n.find(".comment-foot > a.user")[0].href,a=s.substr(s.lastIndexOf("/")+1)===p.user.name;if(i[0]){const r=i[0].id;let m=document.createElement("a");m.href=`#${r}`,m.className="fa fa-level-up action preview-link",n.find(".comment-foot").append(m),a&&n[0].classList.add("own-comment"),m.addEventListener("mouseover",()=>{F.handleMouseover(r,m)})}}})}}class Z{constructor(){o(this,"id","AnonymousTitle");o(this,"name","Anonymous Title");o(this,"description","Entfernt den Top Tag aus dem Titel oder w\xE4hle einen eigenen Titel.");o(this,"customTitle",c.get("AnonymousTitle.settings.custom_title"))}async load(){this.addListeners()}addListeners(){p.mainView.setTitle=()=>this.changeTitle(),window.addEventListener("userSync",()=>this.changeTitle())}changeTitle(){typeof this.customTitle=="string"&&this.customTitle?document.title=p.user.inboxCount>0?"["+p.user.inboxCount+"] "+this.customTitle:this.customTitle:document.title=`${p.user.inboxCount>0?"["+p.user.inboxCount+"]":""} pr0gramm.com \u2013 Die Datingplattform f\xFCr Kellerkinder`}getSettings(){return[{id:"custom_title",title:"cust0m Title",description:"W\xE4hle einen eigenen Title f\xFCr die Seite.",type:"text"}]}}const J=`#user-profile-name{padding-left:1.5em}#user-profile-name:before{font-family:FontAwesome;margin-right:5px;content:"\\f2be"}#user-profile-name.legacy:before{content:" ";background-size:cover;margin-top:1px;margin-left:-20px;height:16px;position:absolute;display:inline-block;width:16px;background-image:url(https://i.imgur.com/7Q2UJeU.png)}
`;class Q{constructor(){o(this,"id","BenisInNavbar");o(this,"name","Benis in Navigation");o(this,"description","Zeigt deinen aktuellen Benis in der Headerleiste an");o(this,"isLegacyIcon",c.get(`${this.id}.settings.lagcy_icon`));o(this,"showUsername",c.get(`${this.id}.settings.show_username`));o(this,"target",document.getElementById("user-profile-name"));o(this,"benis","-")}async load(){if(this.target===null)throw new Error("Could not find target");this.isLegacyIcon&&this.target.classList.add("legacy"),this.addListener(),this.addBenis(),u(J)}getSettings(){return[{id:"legacy_icon",title:"cust0m Icon",description:"Nutze das alte Icon vom cust0m-pr0gramm.",type:"checkbox"},{id:"show_username",title:"Benutzername neben der Benisanzeige",description:"Zeigt neben der Benisanzeige deinen Nutzernamen an.",type:"checkbox"}]}addBenis(){let e=c.get("BenisInNavbar.settings.show_username");this.target.innerText=e?p.user.name+" ("+this.benis+")":this.benis}addListener(){window.addEventListener("userSync",e=>{this.benis=String(e.data.score),this.addBenis()})}}const X=`.private-message-pane .private-messages{max-width:unset;display:flex;flex-direction:column;margin-left:0;flex-grow:1;height:100%}.private-message-pane .private-messages .inbox-messages{max-height:100%;flex-grow:1;overflow-y:scroll;height:100%}.private-message-pane .private-messages .inbox-messages .message{padding:10px;margin:0 0 48px;background-color:#2a2e31}.private-message-pane .private-messages .inbox-messages .message .comment-content,.private-message-pane .private-messages .inbox-messages .message .comment-foot{margin-left:0;margin-right:0;padding:0!important}.private-message-pane .private-messages .inbox-messages .message .comment-foot{position:absolute;margin-top:20px;white-space:nowrap;left:0}.private-message-pane .private-messages .inbox-messages .message.message-own{background-color:var(--theme-main-color);color:#fff}.private-message-pane .private-messages .inbox-messages .message.message-own .comment-foot{position:absolute;margin-top:20px;white-space:nowrap;right:0;left:unset}.private-message-pane .private-messages .inbox-messages .message.message-own a{color:#ddd}.private-message-pane .private-messages .private-message-form{order:1;margin-bottom:0;display:flex;flex-shrink:0;padding:10px 10px 0}.private-message-pane .private-messages .private-message-form textarea{min-height:60px;margin-bottom:0;margin-right:10px;padding:10px;transition:height .1s linear}.private-message-pane .private-messages .private-message-form textarea:focus{height:100px}.private-message-pane .private-messages .private-message-form input[type=submit]{height:100%}.private-message-pane .conversations-pane{float:right;border-right:none;border-left:1px solid #252525;max-height:100%;padding-bottom:0}.private-message-pane .conversations-pane .conversation-tab{padding:8px 0 8px 10px}
`;class Y{constructor(){o(this,"id","Chat");o(this,"name","[WIP] Chat");o(this,"description","Missbrauche die PMs als Chat.")}async load(){this.overrideView(),u(X)}overrideView(){p.View.InboxMessages.Conversations=p.View.InboxMessages.Conversations.extend({show:function(){let e=this.$container.parents(".pane"),t=e.offset().top;e.addClass("private-message-pane"),e.css("height",`calc(100vh - ${t}px)`),e.find(".conversations-pane").toArray(),this.parent()}}),p.View.InboxMessages.Messages=p.View.InboxMessages.Messages.extend({show:function(){this.data.messages.reverse(),this.parent();let e=this.$container.parents(".inbox-messages");e.get(0).scrollTo(0,e.get(0).scrollHeight)}})}}const S={SFW:0,NSFW:1,NSFL:2};class ee{constructor(){o(this,"id","DefaultFilter");o(this,"name","Standard Filter");o(this,"description","Standardfilter, der mit dem Aufruf von pr0 gesetzt wird. Der Filter greift <b><u>nur</u> beim Aufruf der Content-Seite und beim Wechseln zwischen SFW/NSFW/NSFL.</b> Danach kann der Filter vom User angepasst werden. Der Filter greift <b><u>nicht</u> beim Betrachten von User-Uploads oder Sammlungen</b>");o(this,"sfwFilter",c.get(`${this.id}.settings.sfw_filter`));o(this,"nsfwFilter",c.get(`${this.id}.settings.nsfw_filter`));o(this,"nsflFilter",c.get(`${this.id}.settings.nsfl_filter`))}getSettings(){return[{id:"sfw_filter",title:"SFW Filter",description:'Standardfilter f\xFCr SFW (ohne f\xFChrendes !) <br />Beispiele:<ul><li> oc | "original content"</li><li> s:shit | s:500 & (oc | "original content")</li></ul>',type:"text"},{id:"nsfw_filter",title:"NSFW Filter",description:'Standardfilter f\xFCr NSFW (ohne f\xFChrendes !) <br />Beispiele:<ul><li> oc | "original content"</li><li> s:shit | s:500 & (oc | "original content")</li></ul>',type:"text"},{id:"nsfl_filter",title:"NSFL Filter",description:'Standardfilter f\xFCr NSFL (ohne f\xFChrendes !) <br />Beispiele:<ul><li> oc | "original content"</li><li> s:shit | s:500 & (oc | "original content")</li></ul>',type:"text"}]}async load(){if(p.location==="top"||p.location==="new"){const e=this.getFilter();if(e){const t="new/"+encodeURIComponent(e);p.navigateTo(t,p.NAVIGATE.SILENT)}}}getFilter(){const e=this.getCurrentFilters(),t=[];return e.includes(S.SFW)&&this.sfwFilter&&t.push(`${this.sfwFilter.trim()}`),e.includes(S.NSFW)&&this.nsfwFilter&&t.push(`${this.nsfwFilter.trim()}`),e.includes(S.NSFL)&&this.nsflFilter&&t.push(`${this.nsflFilter.trim()}`),t.length>0?"! "+t.filter(n=>!!n).map(n=>`(${n})`).join(" | "):""}getCurrentFilters(){const e=Number(p.user.flags);if(isNaN(e))throw new Error("Flags could not be parsed");const t=[];return(e&1<<0)!==0&&t.push(S.SFW),(e&1<<1)!==0&&t.push(S.NSFW),(e&1<<2)!==0&&t.push(S.NSFL),t}}class te{constructor(){o(this,"id","DesktopNotifications");o(this,"name","Desktop Notifications");o(this,"description","Informiert bei neuen Nachrichten");o(this,"notifications",0)}async load(){window.addEventListener("userSync",e=>{const t=e;t.data.inbox.messages>this.notifications&&A("Du hast "+(t.data.inbox.messages===1?"eine ungelesene Nachricht!":t.data.inbox.messages+" ungelesene Nachrichten!"),"pr0gramm","http://pr0gramm.com/media/pr0gramm-favicon.png",function(){window.focus(),window.location.href="/inbox/messages"}),this.notifications=t.data.inbox.messages})}}const ne=`.item-details .badge{padding:3px 5px;font-size:10px;margin-left:10px;border-radius:3px}.item-details .badge.sfw{background-color:#5cb85c}.item-details .badge.nsfw{background-color:#f0ad4e}.item-details .badge.nsfl{background-color:#d9534f}.item-details .badge.nsfp{background-color:#004085}.thumb.filter{position:relative;overflow:hidden}.thumb.filter:before{content:"";position:absolute;right:-10px;bottom:-10px;z-index:9;height:20px;width:20px;transform:rotate(45deg)}.thumb.filter.sfw:before{background-color:#5cb85c}.thumb.filter.nsfw:before{background-color:#f0ad4e}.thumb.filter.nsfl:before{background-color:#d9534f}.thumb.filter.nsfp:before{background-color:#004085}.thumb.filter>.benis-info{position:absolute;bottom:0;right:0;padding:2px 14px 2px 4px;background-color:#000c;font-size:10px;color:#f2f5f4;z-index:8;display:none}.thumb.filter>.benis-info.down{color:#d9534f}.thumb.filter>.sticky-badge:after{z-index:5}.thumb.filter:hover>.benis-info{display:inline}
`;class M{constructor(){o(this,"id","FilterMarks");o(this,"name","Filtermarkierung");o(this,"description","Markiert Medien entsprechend ihres Filters.");o(this,"displayLabelDetails",c.get("FilterMarks.settings.detail_filters"));o(this,"displayLabelStream",c.get("FilterMarks.settings.stream_filters"));o(this,"displayBenisStream",c.get("FilterMarks.settings.stream_benis"))}static displayFilterLabel(e,t){let n=M.getFilter(e),i=document.createElement("span");i.className="badge",i.classList.toggle(n),i.innerText=n.toUpperCase(),t.find(".item-details")[0].appendChild(i)}static getFilter(e){switch(e.flags){case 1:return"sfw";case 2:return"nsfw";case 4:return"nsfl";case 8:return"nsfp";default:throw new Error("Uknown Filter")}}getSettings(){return[{id:"stream_filters",title:"Filter in Streams",description:"Filterecken in Listen anzeigen?",type:"checkbox"},{id:"detail_filters",title:"Filter in Medienansicht",description:"Filterlabel in der Detailansicht einblenden?",type:"checkbox"},{id:"stream_benis",title:"Benis beim Mouseover",description:"Benis in der \xDCbersicht einblenden?",type:"checkbox"}]}async load(){this.overrideViews(),u(ne)}overrideViews(){let e=this;(this.displayLabelStream||this.displayBenisStream)&&(p.View.Stream.Main.prototype.buildItem=function(t){const n=!p.mobile&&!!t.preview;return`
                    <a class="silent thumb filter ${e.displayLabelStream?M.getFilter(t):""}" ${n?'data-has-preview="true"':""} id="item-${t.id}" href="${this.baseURL+t.id}">
                        <p-thumbnail
                            itemId="${t.id}"
                            thumbSrc="${t.thumb}"
                            ${t.preview?`previewSrc="${t.preview}"`:""}
                        ></p-thumbnail>
                        ${e.displayBenisStream?`
                        <span 
                            class="benis-info ${t.up-t.down>0?"up":"down"}">
                            ${t.up-t.down}
                        </span>`:""}
                        ${n?`
                        <video
                            class="inline-preview-video"
                            preload="none"
                            loop
                            muted
                            width="128"
                            height="128"
                            src="${t.preview}"
                        >`:""}
                        ${t.promoted>1e9?'<div class="sticky-badge"></div>':""}
                    </a>
                `}),this.displayLabelDetails&&(p.View.Stream.Item=p.View.Stream.Item.extend({show:function(t,n,i,s){this.parent(t,n,i,s),e.displayLabelDetails&&M.displayFilterLabel(n,this.$container)}})),x.addVideoConstants()}}const ie=`<span class="fa fa-close close-popup"></span>
<pre class="content">test</pre>
`,oe=`.ocr-button{position:absolute;top:20px;left:24px;color:#fff;opacity:.7;font-size:22px;text-shadow:0 0 3px #000;z-index:10}.ocr-button:hover{color:var(--theme-main-color);opacity:1;text-shadow:none;cursor:pointer}#ocr-popup{border-top:3px solid #2a2e31;max-height:40vh;display:none;overflow:hidden}#ocr-popup.visible{display:flex}#ocr-popup pre{padding:10px;font-family:sans-serif;text-align:center;width:100%}#ocr-popup .close-popup{position:fixed;font-size:20px;right:15px;margin-top:5px;cursor:pointer}#ocr-popup .close-popup:hover{color:var(--theme-main-color)}
`;class se{constructor(){o(this,"id","ImageOCR");o(this,"name","Texterkennung");o(this,"description","Extrahiere Text aus Bildern.");o(this,"searchWording","Verarbeite Bild...");o(this,"popup");o(this,"$popup");o(this,"textbox");o(this,"close")}async load(){const e=document.createElement("div");e.id="ocr-popup",this.popup=e,this.$popup=$(this.popup),this.popup.innerHTML=ie,this.textbox=this.$popup.find(".content")[0],this.close=this.$popup.find(".close-popup")[0],this.addButton(),u(oe)}addButton(){let e=this;p.View.Stream.Item=p.View.Stream.Item.extend({show:function(t,n,i,s){if(this.parent(t,n,i,s),n.video===!1){let a=this.$image.parent(),r=document.createElement("span");r.innerHTML='<span class="fa fa-search ocr-button"></span>',a[0].appendChild(r),r.addEventListener("click",()=>{$(".item-image-wrapper").after(e.popup),e.checkImage()}),e.close.addEventListener("click",()=>{e.togglePopup()})}}}),x.addVideoConstants()}checkImage(){let e=document.getElementsByClassName("item-image-actual")[0];this.textbox.innerText=this.searchWording,this.popup.classList.add("visible"),T({url:e.src,method:"GET",responseType:"arraybuffer",headers:{"cache-control":"no-cache","Upgrade-Insecure-Requests":"1"},onload:t=>{W.default.recognize(new Blob([new Uint8Array(t.response)]),"deu").then(n=>{this.togglePopup(n.data.text)}).catch(n=>{this.togglePopup()})}})}togglePopup(e){if(!e)return this.popup.classList.remove("visible"),!1;this.textbox.innerText=e}}const ae=`<ul id="new-messages">
</ul>
<div>
    <a href="/inbox/all" class="action">Alle Benachrichtigungen</a>
</div>
`,re=`<div>
    ##THUMB##
</div>
<a href="##URL##" class="content">
    <div class="headline">##TITLE##</div>
    <div class="text">##TEXT##</div>
    <span  class="user um##MARK##">##USER##</span>
    <span class="time permalink">##TIME##</span>
</a>
`,me=`#inbox-link{position:relative}#inbox-link.active{color:var(--theme-main-color)}#notification-center{display:none;position:absolute;top:52px;right:0px;z-index:100;border:3px solid #2a2e31;background-color:#161618;box-shadow:2px 0 10px #000;min-width:300px;max-height:50vh;flex-direction:column;overflow-y:scroll}#notification-center.visible{display:flex}#notification-center>div{padding:10px;text-align:center;border-top:1px solid #252525}#notification-center #new-messages{padding-left:10px;margin:0}#notification-center #new-messages.loading{text-align:center;justify-content:center;padding:10px}#notification-center #new-messages.loading .fa-spin{font-size:24px}#notification-center #new-messages .simplebar-scrollbar{background:#2a2e31;right:0;border-radius:0}#notification-center #new-messages .simplebar-scrollbar.visible{opacity:1}#notification-center #new-messages li{align-items:center;justify-content:center;display:flex;opacity:.5}#notification-center #new-messages li:not(:last-child){border-bottom:1px solid #252525}#notification-center #new-messages li:hover{opacity:1}#notification-center #new-messages li:hover .headline{color:var(--theme-main-color)}#notification-center #new-messages li.new{opacity:1}#notification-center #new-messages li.new .message:before{content:"\\f0e0"}#notification-center #new-messages li.no-notifications{text-align:center;width:100%;padding:10px}#notification-center #new-messages li .headline{color:#fff;font-weight:700}#notification-center #new-messages li .comment-thumb{height:42px;width:42px}#notification-center #new-messages li .content{padding:10px;flex-grow:1}#notification-center #new-messages li .content small{display:block;font-size:12px;font-weight:400;color:#666}#notification-center #new-messages li .content .time{float:right}#notification-center #new-messages li .content .text{text-overflow:ellipsis;max-width:200px;color:#666;white-space:nowrap;overflow:hidden}#notification-center #new-messages li .content span{font-size:12px}#notification-center #new-messages li .message{width:42px;margin-left:4px;font-size:34px;margin-right:-4px}
`;class B{constructor(){o(this,"id","NotificationCenter");o(this,"name","Nachrichten Schnellzugriff");o(this,"description","\xD6ffnet neue Benachrichtigungen in einem kleinen Men\xFC");o(this,"showUnreadMessages",c.get("NotificationCenter.settings.show_unread_messages"));o(this,"menuOpen",!1);o(this,"icon",$("#inbox-link"));o(this,"elem",document.createElement("div"));o(this,"messageContainer",null)}static getTitle(e){return e.thumb===null?"Private Nachricht":"Kommentar"}async load(){this.elem.innerHTML=ae,this.elem.id="notification-center",document.querySelectorAll(".user-info.user-only")[0].appendChild(this.elem),this.messageContainer=document.getElementById("new-messages"),this.addListener(),u(me)}getSettings(){return[{id:"show_unread_messages",title:"Ungelesene Nachrichten Anzeigen",description:"Zeigt auch ungelesene Nachrichten an, es werden allerdings nur gelesene hervorgehoben",type:"checkbox"}]}addListener(){this.icon.unbind("click"),this.icon[0].addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.toggleMenu()}),window.addEventListener("click",e=>{this.menuOpen&&($(e.target).parents("#notification-center")[0]||(e.preventDefault(),this.toggleMenu()))})}toggleMenu(){this.menuOpen=!this.menuOpen,this.icon[0].classList.toggle("active"),this.elem.classList.toggle("visible");const e=this.messageContainer;e&&(e.innerHTML='<span class="fa fa-spinner fa-spin"></span>',e.classList.add("loading"),this.getNotifications(!0).then(t=>{let n=t.messages,i=n.filter(s=>!s.read).length;if(e.innerHTML="",e.classList.remove("loading"),p.user.setInboxLink({notifications:0,mentions:0,messages:0,comments:0,follows:0}),i<=0){let s=document.createElement("li");if(s.innerText="Keine neuen Benachrichtigungen!",s.className="no-notifications",e.appendChild(s),!this.showUnreadMessages)return!1}n.filter(s=>s.message!==null).forEach(s=>{this.addEntry(B.getTitle(s),s.name,s.created,s.thumb,s.mark,s.itemId,s.id,s.message,s.read)})}))}getNotifications(e=!1){return new Promise((t,n)=>{p.api.get(e?"inbox.all":"inbox.conversations",{},t,n)})}addEntry(e,t,n,i,s,a,r,m,d){var f;let g=document.createElement("li");g.id=`notification-${r}`;let h='<img src="//thumb.pr0gramm.com/##THUMB##" class="comment-thumb">',L=i?`/new/${a}:comment${r}`:`/inbox/messages/${t}`;i?h=h.replace("##THUMB",i):h='<span class="message fa fa-envelope-open"></span>',t===null&&(t="Systembenachrichtigung"),g.innerHTML=re.replace("##TITLE##",e).replace("##USER##",t).replace("##TIME##",new Intl.DateTimeFormat("de-DE",{dateStyle:"medium",timeStyle:"short"}).format(new Date(n*1e3))).replace("##THUMB##",h).replace("##URL##",L).replace("##MARK##",s).replace("##TEXT##",x.escapeHtml(m)),$(g).on("click",v=>{v.preventDefault();const E=$(v.target).closest("a").first().attr("href");E&&(this.menuOpen&&this.toggleMenu(),p.navigateTo(E.substring(1)))}),d||g.classList.add("new"),(f=this.messageContainer)==null||f.appendChild(g)}}class C{constructor(e){this.data=e,this.target=document.getElementById("container"),this.link=document.createElement("a"),this.textLength=30,this.wordings={country:{de:"Deutschland",at:"\xD6sterreich",ch:"Schweiz",other:"Andere"}},this.colors=["#ee4d2e","#1db992","#bfbc06","#008fff","#ff0082","#fc8833","#5cb85c","#d9534f","#75c0c7"],this.init()}static htmlDecode(e){const t=new DOMParser().parseFromString(e,"text/html");return t.documentElement.textContent!=="null"?t.documentElement.textContent:!1}static handleError(e){return window.stop(),document.body.innerHTML=`<p class="error">${e}</p>`,!1}init(){if(!this.data)return C.handleError("ID missing");document.body.appendChild(this.link);let e=this.getQuestions(this.data);for(let t=1;t<e.length;t++){let n=this.createPr0p0llDiagramm(e[t][1],t);this.target.appendChild(n.container),this.switchChart(n.canvas,n.answers)}}getQuestions(e){let t=Object.keys(e).map(function(n){return[n,e[n]]});return t.splice(0,0),t}getAnswers(e){let t={titles:{long:[],short:[]},answers:[],values:[]};for(let n=0;n<20;n++)e["a"+n]&&(t.titles.long.push(C.htmlDecode(e["a"+n].title)),t.titles.short.push(this.truncate(C.htmlDecode(e["a"+n].title))),t.values.push(e["a"+n].result.total),t.answers.push(e["a"+n]));return t}createPr0p0llDiagramm(e,t){let n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("canvas");const a=this.getAnswers(e),r=C.htmlDecode(e.description);return i.className="wrapper",n.innerHTML=`<h3 id="question-${t}"><span>#${t}</span>${e.title}<small>${r||""}</small></h3>`,s.setAttribute("height",a.answers.length*40),s.setAttribute("width",100),i.appendChild(this.buildNav(s,a)),i.appendChild(this.buildToolsBar(s,a)),i.appendChild(s),n.appendChild(i),{container:n,canvas:s,answers:a}}switchChart(e,t,n="horizontalBar",i=!1){if(e.chart)return e.chart.data.datasets=this.getDatasets(t,i),e.chart.type=n,e.filter=i,e.chart.update(),!0;let s=e.getContext("2d");e.chart=new O.default(s,{type:n,data:{labels:t.titles.short,origTitles:t.titles.long,datasets:this.getDatasets(t,i)},options:{responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom"},tooltips:{mode:"index",intersect:!1,callbacks:{title:function(a,r){return r.origTitles[a[0].index]},label:function(a,r){let m=r.datasets[a.datasetIndex],d=m.data[a.index],g=0,h=0;for(let v=0;v<r.datasets.length;v++)typeof r.datasets[v].data=="object"&&(h+=r.datasets[v].data[a.index],g+=r.datasets[v].data.reduce(function(N,E,U,R){return N+E}));let L=Math.floor(d/h*100+.5)||0,f=Math.floor(d/g*100+.5)||0;return r.datasets.length>1?`${L}% ${m.label} (${f}% Global, ${d} Votes)`:`${f}% ${m.label} (${d} Votes)`}}},scales:{yAxes:[{stacked:!0,gridLines:{color:"#333"},ticks:{fontColor:"#888",fontSize:14}}],xAxes:[{stacked:!0,gridLines:{color:"#333"},ticks:{minRotation:0,maxRotation:0,fontColor:"#888",fontSize:14}}]},onClick:(a,r)=>{if(r[0]){let m=t.answers[r[0]._index];console.log(m)}}}})}getNamedResults(e,t,n){let i=[];for(let a=0;a<t.answers.length;a++){let r=t.answers[a].result[n];for(let m in r)r.hasOwnProperty(m)&&(i[m]||(i[m]=[]),i[m].push(r[m]))}let s=0;for(let a in i)if(i.hasOwnProperty(a)){let r=a;this.wordings[n]&&(r=this.wordings[n][a]),e.push({label:C.htmlDecode(r),data:i[a],backgroundColor:this.colors[s]}),s++}}getDatasets(e,t){let n=[];switch(t){case"age":this.getNamedResults(n,e,"age");break;case"gender":let i=[],s=[];for(let a=0;a<e.answers.length;a++)i.push(e.answers[a].result.gender.w),s.push(e.answers[a].result.gender.m);n.push({label:"Weiblich",data:i,backgroundColor:this.colors[0]}),n.push({label:"M\xE4nnlich",data:s,backgroundColor:this.colors[3]});break;case"location":this.getNamedResults(n,e,"country");break;default:n.push({label:"Gesamtstimmen",data:e.values,backgroundColor:this.getRandomColor()});break}return n}truncate(e){return e.length>this.textLength?e.substr(0,this.textLength)+"...":e}buildNav(e,t){let n=document.createElement("ul");return n.innerHTML=`
            <li><a data-filter="default" class="active"><span class="fa fa-bar-chart"></span></a></li>
	        <li><a data-filter="age" title="Verteilung nach Alter"><span class="fa fa-child"></span></a></li>
	        <li><a data-filter="gender" title="Geschlechteraufteilung"><span class="fa fa-mars"></span></a></li>
	        <li><a data-filter="location" title="Herkunftsland"><span class="fa fa-map-marker"></span></a></li>
	    `,n.addEventListener("click",i=>{let s=i.target.parentNode.dataset.filter;if(s){let a=n.getElementsByClassName("active")[0];a&&a.classList.remove("active"),i.target.parentNode.classList.toggle("active"),this.switchChart(e,t,"bar",s)}}),n}buildToolsBar(e,t){let n=document.createElement("ul");return n.className="toolbar",n.innerHTML='<a id="download" class="fa fa-download">Download</a><a id="switch" class="fa fa-pie-chart">Typ</a>',n.addEventListener("click",i=>{switch(i.target.id){case"download":this.downloadChart(e);break;case"switch":let s=e.chart.config.type==="bar"?"horizontalBar":"bar";e.chart.destroy(),e.chart=!1,this.switchChart(e,t,s,e.filter);break}}),n}downloadChart(e){this.link.href=e.toDataURL("image/png"),this.link.download="diagram.png",this.link.click()}getRandomColor(){return this.colors[Math.floor(Math.random()*this.colors.length)]}}const ce=`<div class="overlay-content">
    <h2>
        <?js print(p0ll.info.title)?>
        <span class="description"><?js print(p0ll.info.description)?></span>
    </h2>
    <h3 class="center">
        <span>
            <a href="https://pr0p0ll.com/?p=join&pollid=<?js print(p0ll.info.pollid)?>"
               title="Zur Umfrage" target="_blank">Zur Umfrage</a>
        </span>
        <span>
            Author:
            <?js if (p0ll.info.author) { ?>
            <a href="//pr0gramm.com/user/<?js print(p0ll.info.author)?>"
               target="_blank"><?js print(p0ll.info.author)?></a>
            <?js } else { ?>
            <span class="white">Anonym</span>
            <?js } ?>
        </span>
        <span>Zeitraum: <?js print(dateFrom)?> - <?js print(dateTo)?></span>
    </h3>
</div>
<div class="overlay-content">
    <div id="container"></div>
</div>
`,le=`.pr0p0ll-count{margin:0 10px 0 0;color:var(--theme-main-color)}.pr0p0ll-count.empty{color:#f5f7f6}.pr0p0ll-count.empty:hover{color:var(--theme-main-color)}.pr0p0ll-count:before{margin-right:3px}.pr0p0ll-count:hover{color:#f5f7f6}.pr0p0ll-link{color:var(--theme-main-color);margin-left:5px;cursor:pointer}.pr0p0ll-link:hover{color:#f5f7f6}#overlay-box.pr0p0ll-overlay{width:80%;bottom:15%;overflow-x:hidden}#overlay-box.pr0p0ll-overlay #container{max-width:1052px;margin:0 auto}#overlay-box.pr0p0ll-overlay #container>div:not(:last-child){margin-bottom:60px}#overlay-box.pr0p0ll-overlay a{color:#f2f5f4}#overlay-box.pr0p0ll-overlay a:hover{color:#75c0c7}#overlay-box.pr0p0ll-overlay a.fa{font-family:sans-serif}#overlay-box.pr0p0ll-overlay a.fa:before{margin-right:5px;font: 14px/1 FontAwesome}#overlay-box.pr0p0ll-overlay h2{text-align:center}#overlay-box.pr0p0ll-overlay h2 span{display:block;text-transform:none;color:#888;font-size:18px}#overlay-box.pr0p0ll-overlay h3>span{font-weight:400;color:#888;margin:0 10px;font-style:italic}#overlay-box.pr0p0ll-overlay h3.center{text-align:center;text-transform:none;color:#888}#overlay-box.pr0p0ll-overlay h3.center .white{color:#f2f5f4}#overlay-box.pr0p0ll-overlay h3 small{display:block;font-size:16px;font-weight:400;margin-top:5px;color:#888}#overlay-box.pr0p0ll-overlay .canvasWrapper{flex-grow:1}#overlay-box.pr0p0ll-overlay .wrapper{display:flex;position:relative}#overlay-box.pr0p0ll-overlay .wrapper>ul.toolbar{position:absolute;right:0;margin:0;display:inline-block;top:-15px;font-size:12px}#overlay-box.pr0p0ll-overlay .wrapper>ul.toolbar a{cursor:pointer}#overlay-box.pr0p0ll-overlay .wrapper>ul.toolbar a:not(:last-child){margin-right:15px}#overlay-box.pr0p0ll-overlay .wrapper>ul:not(.toolbar){padding:0;list-style:none;display:flex;flex-direction:column;height:100%;margin:0;align-items:center;justify-content:center}#overlay-box.pr0p0ll-overlay .wrapper>ul:not(.toolbar) li{padding-bottom:10px}#overlay-box.pr0p0ll-overlay .wrapper>ul:not(.toolbar) li a{color:#888;cursor:pointer;font-size:26px}#overlay-box.pr0p0ll-overlay .wrapper>ul:not(.toolbar) li a:hover{color:#f2f5f4}#overlay-box.pr0p0ll-overlay .wrapper>ul:not(.toolbar) li a.active{color:#ee4d2e}#overlay-box.pr0p0ll-overlay #questionwrapper{margin-bottom:60px!important;background-color:#212121;padding:20px}#overlay-box.pr0p0ll-overlay #questionwrapper h3{margin-top:0;margin-bottom:20px}#overlay-box.pr0p0ll-overlay #questionwrapper ul{padding-left:20px;list-style:none}#overlay-box.pr0p0ll-overlay #questionwrapper ul li:not(:last-child){margin-bottom:10px}#overlay-box.pr0p0ll-overlay #questionwrapper ul li a span{color:#bbb;font-style:italic;margin-right:5px}#overlay-box.pr0p0ll-overlay .error{text-align:center;color:#fff;background-color:red;margin:0 auto;padding:10px}
`;class de{constructor(){o(this,"id","Pr0p0ll");o(this,"name","Pr0p0ll Integration");o(this,"description","Erhalte Benachrichtigungen \xFCber neue Umfragen!");o(this,"showNotification",c.get("Pr0p0ll.settings.show_notification"));o(this,"token",c.get("Pr0p0ll.settings.user_token"));o(this,"showDiagramms",c.get("Pr0p0ll.settings.show_diagramms"));o(this,"apiUrl","https://pr0p0ll.com/?p=viewjson&id=");o(this,"regionDe",new Intl.DateTimeFormat("de-DE",{dateStyle:"long",timeZone:"Europe/Berlin"}));o(this,"inboxLink");o(this,"target",null);o(this,"template",'<a href="https://pr0p0ll.com/?p=user" target="_blank" class="empty pr0p0ll-count fa fa-edit head-link"><span>0</span></a>');this.inboxLink=document.getElementById("inbox-link")}async load(){this.inboxLink.after($(this.template)[0]),this.target=this.inboxLink.nextSibling.firstChild,this.token&&this.addListener();const e=this;p.View.Overlay.Pr0p0llDiagramm=p.View.Base.extend({template:ce,init:function(t,n,i){this.data.p0ll=i.data,console.log(i.data),this.data.dateTo=e.regionDe.format(i.data.info.endedOn*1e3),this.data.dateFrom=e.regionDe.format(i.data.info.endedOn*1e3-i.data.info.duration*1e3),t[0].classList.add("pr0p0ll-overlay"),this.parent(t,n)}}),u(le)}getSettings(){return[{id:"show_notification",title:"Desktopbenachrichtigung",description:"Zeige eine Desktopbenachrichtigung bei neuen Umfragen!",type:"checkbox"},{id:"show_diagramms",title:"Diagramme anzeigen",description:"Diagramme hinter pr0p0ll-links verlinken",type:"checkbox"},{id:"user_token",title:'"Token f\xFCr Notificator"',description:'Damit authentifizierst du dich gegen\xFCber pr0p0ll. [<a href="https://pr0p0ll.com/?p=tokengen" target="_blank">Token generieren</a>]',type:"text"}]}addListener(){const e=this.token.trim();e?/^([0-9a-f]{64})$/.test(e)?(this.token=e.match("^([0-9a-f]{64})$")[0],c.set("Pr0p0ll.settings.user_token",this.token),window.addEventListener("userSync",()=>{this.fetchCounter().then(t=>{this.updateCounter(t.openPolls)})}),this.showDiagramms&&window.addEventListener("commentsLoaded",t=>{let n=t.data.find('a[href*="pr0p0ll"][href*="id="]').toArray();this.addLinks(n)})):window.alert("Bitte \xF6ffne die Einstellungen, um einen korrekten Pr0po0ll-Token einzugeben."):window.alert("Bitte \xF6ffne die Einstellungen um das Pr0p0ll-Modul zu konfigurieren.")}addLinks(e){for(const t of e){const n=new URL(t.href);let i=document.createElement("a");i.className="fa fa-bar-chart pr0p0ll-link",i.addEventListener("click",()=>{const s=n.searchParams.get("pollid"),a=parseInt(s!==null?s:n.searchParams.get("id"));c.set("Pr0p0ll.settings.last_count",String(0)),this.showDiagramm(a)}),t.after(i)}}showDiagramm(e){(()=>new Promise((n,i)=>{T({url:this.apiUrl+e,method:"GET",headers:{"User-Agent":"p0weruser"},onload:s=>{const a=JSON.parse(s.responseText);a.error&&i(a.error),n(a)}})}))().then(n=>{p.mainView.showOverlay(p.View.Overlay.Pr0p0llDiagramm,{data:n}),new C(n)},n=>{window.alert(n)})}fetchCounter(){return new Promise((e,t)=>{T({url:`https://pr0p0ll.com/?p=notify&token=${this.token}`,method:"GET",headers:{"User-Agent":"p0weruser"},onload:n=>{e(JSON.parse(n.responseText))}})})}updateCounter(e){e=parseInt(e)||0,this.showNotification&&c.get("Pr0p0ll.settings.last_count")<e&&A("Du hast "+(e===1?"eine neue Umfrage!":e+" neue Umfragen!"),"pr0p0ll","https://pr0p0ll.com/src/favicon.png",function(){window.focus(),window.location.href="https://pr0p0ll.com/?p=user"}),this.target.parentNode.classList.toggle("empty",e===0||!e),this.target.innerText=e,c.set("Pr0p0ll.settings.last_count",e)}}const pe=`.repost-link{margin-left:15px}.repost-link .fa{color:#f2f5f4;margin-right:5px}.rep0sts{width:33vw;background-color:#161618;border-left:3px solid #2a2e31;overflow-y:auto;overflow-x:clip;height:100%}.rep0sts .sidebar-head{display:flex;align-items:center;background-color:#2a2e31;text-align:left;padding:10px;transition:width .2s ease-out;z-index:400;width:30vw;margin-left:-10px}.rep0sts .sidebar-head .sidebar-label{margin-left:5px}.rep0sts .sidebar-head .close{cursor:pointer;position:fixed;right:10px}.rep0sts a{display:block;margin-bottom:5px;position:relative}.rep0sts a img{max-width:100%}.rep0sts a span{position:absolute;left:5px;bottom:10px;text-shadow:1px 1px 0px black;color:#f2f5f4}.rep0sts a span:hover{color:#75c0c7}.item-container .loader{font-size:45px;margin-top:30px;width:15vw}.probability{position:absolute;top:5px;right:5px;font-weight:700;color:red}.probability:hover{color:#fff;background-color:#2a2e31;border-radius:10px;padding:2px 10px}
`;class he{constructor(){o(this,"closeBtn",{});o(this,"id","Rep0st");o(this,"name","Rep0st Check");o(this,"description","Frage rene8888, ob es sich um einen rep0st handelt.");o(this,"visible",!1);o(this,"$loader")}async load(){let e=this;p.View.Stream.Item=p.View.Stream.Item.extend({show:function(t,n,i,s){this.parent(t,n,i,s),e.addButton(this.$container)},remove:function(){this.parent(),e.visible=!1}}),x.addVideoConstants(),u(pe)}addButton(e){const t=e.find('.item-image-actual:not([src*=".gif"])');if(this.$loader=$('<span class="fa fa-spinner fa-spin loader"></span>'),t[0]&&t[0].tagName!=="VIDEO"){const n=$('<a title="Pr\xFCfe, ob es sich um einen Repost handelt" class="repost-link"><span class="fa fa-copy"></span> rep0st?</a>');e.find(".item-details .user").after(n),n[0].addEventListener("click",()=>{this.visible||this.checkImage(e,t)})}}checkImage(e,t){let n=new FormData,i=$("<div></div>"),s=$('<div class="rep0sts"></div>'),a=$('<div class="sidebar-head"><span class="fa fa-copy"></span><span class="sidebar-label">Reposts</span></div>'),r=$('<span class=" fa fa-close close"></span>');a.append(r),s.append(a),s.append(this.$loader),e.find(".image-main").after(s),r[0].addEventListener("click",()=>{this.visible=!1,s.remove()}),n.append("image",new Blob([],{type:"application/octet-stream"}),""),n.append("url",t[0].src);let m=p.user.flagsName.split("+");m=m.indexOf("all")!==-1?["sfw","nsfw","nsfl"]:m;for(const d of m)n.append("filter",d);T({url:"https://rep0st.rene8888.at/",method:"POST",headers:{"cache-control":"no-cache","Upgrade-Insecure-Requests":"1",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8"},overrideMimeType:"multipart/form-data",data:n,onload:d=>{let g=[];this.visible=!0,this.$loader.remove(),i.html(d.responseText);const h=i.find(".search-results a");let L=this.getCurrentPostId();for(let f=1;f<h.length;f++){let v=parseInt(h[f].href.replace("pr0gramm","").replace(/\D/g,""));if(L!==v){let N=h[f].children[0],E=h[f].href,U=N.children[0].innerHTML,R=N.children[1].src;g.push({url:E,img:R,probability:U})}}this.displayImages(s,g)}})}getCurrentPostId(){return parseInt(window.location.href.replace("pr0gramm","").replace(/\D/g,""))}displayImages(e,t){for(const n of t){let i=`<div class="probability">${n.probability}</div>`;e.append($(`<a href=${n.url} target="_blank"><img src=${n.img} class="rep0st-thumb" />${i}<span title="Als Repost markieren" class="fa fa-comment"></span></a>`)).find(`a[href='${n.url}'] > .fa.fa-comment`)[0].addEventListener("click",r=>{r.preventDefault();let m=$(document.body);const d=`Re: ${n.url}`;let g=m.find(".comment:not(.reply)"),h=m.find(".tag-form");g[0].value=d,g.parent().find('input[type="submit"]')[0].click(),h.find(".item-tagsinput")[0].value="repost",h.find('input[type="submit"]').click()})}}}const ge=`.repost{position:relative}.repost:after{content:"rep0st";position:absolute;color:#fff;z-index:4;left:0;font-weight:700;font-size:18px;top:0;right:0;bottom:0;background-color:#000000bf;display:flex;align-items:center;justify-content:center}
`;class _{constructor(){o(this,"id","RepostMarker");o(this,"name","Repost Markierung");o(this,"description","Markiert Reposts in der \xDCbersicht")}static markRepost(e){let t=document.getElementById("item-"+e);t&&t.classList.add("repost")}async load(){var i;const e=p.Stream.prototype._load,t=this;p.Stream.prototype._load=function(s,a){const r=e.call(this,s,a);return t.loadReposts(s),r};const n=(i=p.currentView)==null?void 0:i.stream;n&&await this.loadReposts(n.options),u(ge)}async loadReposts(e){const t=await new Promise((n,i)=>{p.api.get("items.get",{...e,tags:"repost"},n,i)});for(const n of t.items)_.markRepost(n.id)}}class fe{constructor(){o(this,"id","StatisticsLinkInNavbar");o(this,"name","Link to Statistics");o(this,"description","(Pr0mium) Verlinkt in der Navigation-Bar rechts oben auf die neue Statistik-Seite");o(this,"target",document.getElementsByClassName("user-info user-only")[0])}async load(){this.addStatsLink()}addStatsLink(){let e=document.createElement("a"),t=document.createTextNode("Statistiken");e.classList.add("head-link"),e.id="user-link-stats",e.appendChild(t),e.setAttribute("href","https://pr0gramm.com/userstats"),this.target.appendChild(e)}}const ue=`.transparent#head{width:100%!important;display:flex;justify-content:center;background-color:#000000e6}@supports (backdrop-filter: blur()){.transparent#head{background-color:#00000094!important;backdrop-filter:blur(30px)}}.transparent#head #head-content{background-color:transparent;width:1052px}
`;class ve{constructor(){o(this,"id","StyleCustomization");o(this,"name","Stilisierung");o(this,"description","Einzelne Styleanpassungen");o(this,"isTransparentNavbarEnabled",c.get(`${this.id}.settings.transparent_navbar`));o(this,"hideBenis",c.get(`${this.id}.settings.hide_benis`,!1))}async load(){var e;if(this.isTransparentNavbarEnabled===!0&&((e=document.getElementById("head"))==null||e.classList.add("transparent")),u(ue),this.hideBenis===!0){const t=document.createElement("style");t.innerText=`
                .score, .user-score {
                    color: transparent;
                }
            `,document.head.appendChild(t)}}getSettings(){return[{id:"transparent_navbar",title:"Transparente Navigationsleiste",description:'Die Navigationsleiste wird transparent angezeigt. Inspieriert von <a href="https://github.com/holzmaster/augenzuckerl">Augenzuckerl</a> von <a href="https://pr0gramm.com/user/holzmaster">@holzmaster</a>. Au\xDFerdem wird das Navigationsmen\xFC auch im Widescreen Mode zentriert dargestellt.',type:"checkbox"},{id:"hide_benis",title:"Versteckt den Benis",description:"Versteckt den Benis bei Posts, Kommenteren und Nutzern. Der Benis wird nur \xFCber unsichtbare Schrift versteckt und kann \xFCber eine Markierung sichtbar gemacht werden - wie Zaubertinte",type:"checkbox"}]}}const be=`.thumb.viewed{position:relative}.thumb.viewed:after{font-family:FontAwesome,sans-serif}.thumb.viewed:not(.repost):after,.thumb.viewed .active:after{content:"\\f00c";position:absolute;color:#fff;z-index:4;left:0;font-weight:700;font-size:18px;top:0;right:0;bottom:0;background-color:#000000bf;display:flex;align-items:center;justify-content:center;height:inherit;width:inherit;border:none!important}.thumb.viewed.repost:after{content:"rep0st / \\f00c"}
`;class I{constructor(){o(this,"id","ViewedPostsMarker");o(this,"name",'"Bereits gesehen"-Markierung');o(this,"description","Markiert bereits gesehene Medien.");o(this,"markOwnFavoritesAsViewed",c.get("ViewedPostsMarker.settings.mark_own_favorites_as_viewed"));o(this,"viewedPosts",I.getViewedPosts())}async load(){let e=this;$(document).ajaxComplete((t,n,i)=>{i.url.startsWith("/api/items/get")&&(this.markOwnFavoritesAsViewed||!this.wouldLoadUserCollection(i.url))&&this.viewedPosts.forEach(s=>{I.markAsViewed(s)})}),p.View.Stream.Item=p.View.Stream.Item.extend({show:function(t,n,i,s){this.parent(t,n,i,s),e.addViewedPost(n.id),I.markAsViewed(n.id)}}),x.addVideoConstants(),u(be)}static markAsViewed(e){let t=document.querySelector(`#item-${e} > p-thumbnail`);t&&t.setAttribute("seen","")}static getViewedPosts(){let e=c.get("viewed_posts");return e===!0?[]:JSON.parse(e)}getSettings(){return[{id:"mark_own_favorites_as_viewed",title:"Eigene Favoriten ebenfalls als gelesen markieren",description:"Markiert Posts in den pers\xF6nlichen Sammlungen als gelesen",type:"checkbox"}]}addViewedPost(e){this.viewedPosts.length>=1e4&&(this.viewedPosts=this.viewedPosts.slice(-1e4)),this.viewedPosts.indexOf(e)===-1&&this.viewedPosts.push(e),c.set("viewed_posts",JSON.stringify(this.viewedPosts))}wouldLoadUserCollection(e){const t=p.user.name,n=new URLSearchParams(e);return n.has("collection")&&n.get("user")===t}}const xe=`body[class] #head-content:after{left:15px}body[class] #head-content div#cancer-donations{position:relative;top:4px;order:3;left:10px}body[class].fixed{overflow:hidden}body[class]>.side-wide-skyscraper{display:none}body[class] #page.desktop,body[class] #page #head{padding:0 20px;width:100%!important}body[class] #page.desktop #pr0-miner,body[class] #page #head #pr0-miner{display:none}body[class] #page #main-view #stream{text-align:center;display:block;margin:0 auto}body[class] #page #main-view #stream a.thumb{display:block;float:left}body[class] #page #main-view #stream .stream-row{clear:none;text-align:center}body[class] #page #head{background:rgba(0,0,0,.8);width:100%!important}body[class] #page #head #head-content{background:none;display:flex;align-items:center}body[class] #page #head #head-content #loader{left:-20px;right:-20px}body[class] #page #head #head-content #filter-menu{left:calc(50% - 135px)}body[class] #page #head #head-content>.user-info{order:20;margin:0}body[class] #page #head #head-content>#head-menu{padding:0;order:3;flex-grow:1;display:flex;align-items:center;justify-content:center}body[class] #page #head #head-content>#pr0gramm-logo-link{order:1;height:24px;margin:0}body[class] #page #head #head-content a[id*=badge]{order:2;position:relative;top:0;left:0;margin-left:5px;transform:scale(.75)}body[class] #page #head #head-content .sidebar-toggle{order:0;color:#fff;font-size:20px;margin-right:10px}body[class] #page #head #head-content .sidebar-toggle.active{color:#ee4d2e}body[class]>#footer-links{width:250px;left:-250px!important;position:fixed;margin:0;top:52px;border-right:3px solid #2a2e31;background:#161618;transition:left .2s linear;z-index:500}body[class]>#footer-links.open{left:0!important;box-shadow:2px 0 10px #000}body[class]>#footer-links a{color:#fff;display:block;text-align:left;padding:10px 20px;margin-right:0;font-size:16px}body[class]>#footer-links a:hover{color:#ee4d2e}body[class]>#footer-links a:before{font-family:FontAwesome;margin-right:10px;display:inline-block;width:20px}body[class]>#footer-links a[href="/faq"]:before{content:"\\f059"}body[class]>#footer-links a[href="/contact"]:before{content:"\\f0e0"}body[class]>#footer-links a[href*="//miner.pr0gramm.com"]:before{content:"\\f15a"}body[class]>#footer-links a[href*="/datasafety"]:before{content:"\\f06e"}body[class]>#footer-links a[href="http://app.pr0gramm.com"]:before{content:"\\f10b"}body[class]>#footer-links a[href="https://twitter.com/pr0gramm"]:before{content:"\\f099"}body[class]>#footer-links a[href="https://pr0mart.com"]:before{content:"\\f07a"}#stream .item-container{margin:0;max-height:calc(100vh - 52px);display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.9);position:fixed;top:52px;right:0;left:-20px;bottom:-20px;padding:0;z-index:10}#stream .item-container .item-pointer{display:none}#stream .item-container .item-container-content{display:flex;overflow:unset;height:100%;width:100%}#stream .item-container .item-container-content.right{flex-direction:row-reverse}#stream .item-container .item-container-content.right .comments-switch{transform:rotate(180deg)}#stream .item-container .item-container-content.right .video-controls{padding-left:30px}#stream .item-container .item-container-content .image-main{position:relative;display:flex;width:100%;flex-direction:column}#stream .item-container .item-container-content .image-main .item-info{display:flex;align-items:center;justify-content:center;min-height:120px}#stream .item-container .item-container-content .image-main .item-info>div{position:relative;display:flex;width:90%;max-width:980px}#stream .item-container .item-container-content .image-main .item-info>div .item-details,#stream .item-container .item-container-content .image-main .item-info>div .item-tags{padding:5px 20px 5px 40px}#stream .item-container .item-container-content .image-main .item-info>div .item-details .item-report{margin-left:10px}#stream .item-container .item-container-content .image-main .item-info>div .item-vote{display:flex;align-items:center;left:0;top:0;position:relative}#stream .item-container .item-container-content .image-main .item-info>div .item-vote .collect{position:relative;left:0;top:0}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div{display:flex;align-items:center;position:relative;min-width:80px}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .vote-fav{position:relative;margin-left:20px;font-size:32px;left:0;top:0}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .score,#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .score-hidden{position:relative;top:0;left:10px}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .benisbar{height:3px;display:none;position:absolute;bottom:-5px;left:0;right:0;background-color:#5cb85c}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .benisbar.show{display:block}#stream .item-container .item-container-content .image-main .item-info>div .item-vote>div .benisbar:after{content:attr(data-after-text);bottom:-20px;position:absolute;color:#bbb;white-space:nowrap}#stream .item-container .item-container-content .image-main .item-image-wrapper{flex-grow:1;overflow:hidden;display:flex;align-items:center;justify-content:center;padding:40px}#stream .item-container .item-container-content .image-main .item-image-wrapper .move-link{position:absolute;color:#fff;opacity:.7;padding:0 24px;font-size:26px;right:0;top:24px;text-shadow:0 0 3px #000;z-index:99999}#stream .item-container .item-container-content .image-main .item-image-wrapper .move-link:hover{color:#ee4d2e}#stream .item-container .item-container-content .image-main .item-image-wrapper div.stream-next,#stream .item-container .item-container-content .image-main .item-image-wrapper div.stream-prev{top:unset;bottom:unset;padding:128px 24px!important}#stream .item-container .item-container-content .image-main .item-image-wrapper .item-fullsize-link+.move-link{top:60px}#stream .item-container .item-container-content .image-main .item-image-wrapper .video-controls{height:50px}#stream .item-container .item-container-content .image-main .item-image-wrapper.resized .item-image{max-height:calc(100vh - 200px);top:auto!important;left:auto!important}#stream .item-container .item-container-content .image-main .item-image-wrapper.oversize:not(.resized) .item-image{cursor:move}#stream .item-container .item-container-content .image-main .item-image-wrapper.oversize:not(.resized) img{max-height:none!important;align-self:flex-start}#stream .item-container .item-container-content .image-main .item-image-wrapper .video-controls{width:100%!important}#stream .item-container .item-container-content .image-main .item-image-wrapper .video-controls .video-position-bar-background{min-height:2px}#stream .item-container .item-container-content .image-main .item-image-wrapper .item-image{outline:none;display:flex;align-items:center;justify-content:center;max-width:100%;max-height:100%;width:auto!important}#stream .item-container .item-container-content .image-main .item-image-wrapper .item-image .item-image-thumb{display:none!important}#stream .item-container .item-container-content .image-main .item-image-wrapper .item-image .item-image-actual{height:auto!important;width:auto!important;max-width:100%;max-height:100%;position:relative;margin:0 auto}#stream .item-container .item-container-content .item-comments{background:#161618;flex-grow:0;flex-shrink:0;border-right:3px solid #2a2e31;transition:width .2s ease-out}#stream .item-container .item-container-content .item-comments.loaded{width:30vw}#stream .item-container .item-container-content .item-comments.loaded.wide{width:40vw}#stream .item-container .item-container-content .item-comments.closed,#stream .item-container .item-container-content .item-comments.closed .comment-count{width:60px!important}#stream .item-container .item-container-content .item-comments.closed .count,#stream .item-container .item-container-content .item-comments.closed .comments-head,#stream .item-container .item-container-content .item-comments.closed .comments-switch{display:none}#stream .item-container .item-container-content .item-comments .vote-cfav{color:#888;font-size:16px;cursor:pointer;position:relative;padding:0 5px 0 0;top:4px}#stream .item-container .item-container-content .item-comments .vote-cfav.faved,#stream .item-container .item-container-content .item-comments .vote-cfav:hover,#stream .item-container .item-container-content .item-comments .comment[voted-up] .vote-up{color:var(--theme-main-color)}#stream .item-container .item-container-content .item-comments .comment[voted-up] .vote-down,#stream .item-container .item-container-content .item-comments .comment[voted-down] .vote-up{color:#3c3c3c}#stream .item-container .item-container-content .item-comments .comment[voted-down] .vote-down{color:#f5f7f6}#stream .item-container .item-container-content .item-comments .comment[voted-down] .comment-content{color:#666}#stream .item-container .item-container-content .item-comments.toggled{transition:width .2s ease-out}#stream .item-container .item-container-content .item-comments.wide{width:40vw}#stream .item-container .item-container-content .item-comments.wide .comments-switch:before{content:"\\f053"}#stream .item-container .item-container-content .item-comments.wide .comment-count{width:40vw}#stream .item-container .item-container-content .item-comments .comments-head{padding:10px 10px 10px 30px;opacity:1;transition:opacity .2s;overflow-y:auto;height:calc(100vh - 90px)}#stream .item-container .item-container-content .item-comments .comments-head .comment-content,#stream .item-container .item-container-content .item-comments .comments-head .comment-foot,#stream .item-container .item-container-content .item-comments .comments-head .comment{max-width:100%}#stream .item-container .item-container-content .item-comments .comments-head .comment-report{margin-right:5px}#stream .item-container .item-container-content .item-comments .comment-count{display:flex;align-items:center;background-color:#2a2e31;text-align:left;padding:10px 10px 10px 35px;transition:width .2s ease-out;z-index:400;width:30vw}#stream .item-container .item-container-content .item-comments .comment-count>div:first-child{flex-grow:1}#stream .item-container .item-container-content .item-comments .comment-count .fa{cursor:pointer}#stream .item-container .item-container-content .item-comments .comment-count .fa:not(:last-child){margin-right:10px}#stream .item-container .item-container-content .item-comments textarea{transition:height .2s ease-out}#stream .item-container .item-container-content .item-comments textarea.comment:focus,#stream .item-container .item-container-content .item-comments textarea.comment:valid,#stream .item-container .item-container-content .item-comments textarea.reply{height:75px}
`,we=`<div class="item-pointer"></div>
<div class="item-container-content">
    <?js if( p.user.admin ) {?>
    <svg class="flags flags-{item.flags}" viewBox="0 0 10 10">
        <polygon points="0,0 10,0 0,10"></polygon>
    </svg>
    <?js } ?>
    <div class="item-comments"></div>
    <div class="image-main">
        <div class="item-image-wrapper">
            <?js if( item.video ) { ?>
            <div class="item-image">
                <?js if(supportsAutoplay) {?>
                <video class="item-image-actual" draggable="true" src="{item.image}" type="video/mp4" loop autoplay
                       preload="auto"></video>
                <?js } else { ?>
                <video class="item-image-actual" draggable="true" webkit-playsinline playsinline poster="{item.thumb}" src="{item.image}"
                       type="video/mp4" loop preload="metadata"></video>
                <svg class="video-play-button" viewBox="0 0 200 200">
                    <circle cx="100" cy="100" r="90" fill="none" stroke-width="15" stroke="#fff"></circle>
                    <polygon points="70, 55 70, 145 145, 100" fill="#fff"></polygon>
                </svg>
                <?js } ?>
            </div>
            <div class="video-controls<?js if(item.audio){?> has-audio<?js}?>">
                <div class="video-position-bar-background">
                    <div class="video-position"></div>
                </div>
                <div class="video-pause-controls" title="Pausieren [p]">
                    <svg class="video-state video-state-playing" viewBox="20 20 160 160">
                        <g class="video-state-play-button">
                            <polygon points="70,50 70,150 150,100" fill="#fff"></polygon>
                        </g>
                        <g class="video-state-pause-button">
                            <polygon points="70,50 70,150 90,150 90,50" fill="#fff"></polygon>
                            <polygon points="110,50 110,150 130,150 130,50" fill="#fff"></polygon>
                        </g>
                    </svg>
                </div>
                <?js if(item.audio) {?>
                <div class="audio-controls" title="Stumm [q]">
                    <svg class="audio-state" viewBox="0 0 75 75">
                        <polygon class="audio-speaker"
                                 points="39.389,13.769 22.235,28.606 6,28.606 6,47.699 21.989,47.699 39.389,62.75 39.389,13.769"/>
                        <g class="audio-x">
                            <path d="M 49,50 69,26"/>
                            <path d="M 69,50 49,26"/>
                        </g>
                        <g class="audio-wave">
                            <path class="audio-wave-1" d="M 48,49 C 50,46 51,42 51,38 C 51,34 50,31 48,28"/>
                            <path class="audio-wave-2" d="M 55,21 C 59,26 61,32 61,38 C 61,45 59,51 55,56"/>
                            <path class="audio-wave-3" d="M 62,63 C 67,56 70,48 70,38 C 70,29 67,21 62,14"/>
                        </g>
                    </svg>
                    <div class="audio-volume-controls">
                        <div class="audio-volume-bar"></div>
                        <div class="audio-volume-slider"></div>
                    </div>
                </div>
                <?js } ?>
            </div>
            <?js } else { ?>
            <div class="item-image">
                <img class="item-image-actual" src="{item.image}"/></div>
            <?js if(item.fullsize) { ?>
            <a href="{item.fullsize}" target="_blank" class="item-fullsize-link">+</a>
            <?js } ?>
            <a class="fa fa-arrows move-link"></a>
            <?js } ?>
            <div class="stream-prev arrow pict" title="Neuer [\u2B60, a]">&lt;</div>
            <div class="stream-next arrow pict" title="\xC4lter [\u2B62, d]">&gt;</div>
            </div>
        <div class="item-info">
            <div>
                <div class="item-vote{p.voteClass(item.vote)}">
                  <div>
                    <div>
                      <span class="pict vote-up">+</span>
                      <span class="pict vote-down">-</span>
                    </div>
                    <?js if( p.shouldShowScore(item) ) {?> <span class="score<?js if(!p.olderThanMinAge(item)){?> score-young<?js}?>"
                      title="{" Blussi".inflects(item.up)}, {item.down} Minus">
                      <?js print((item.up - item.down).toSiUnit()) ?>
                    </span>
                    <?js } else { ?> <span class="score-hidden" title="Benis noch unsichtbar">\u25CF\u25CF\u25CF</span>
                    <?js } ?>
                    <span class="pict vote-fav<?js if (item.fav){ ?> faved<?js } ?>" title="Favorisieren [f]">*</span>
                    <span class="collect" title="In Sammlung einsortieren">\u25BC</span>
                    <div class="benisbar" data-after-text="{item.up} up / {item.down} down"></div>
                  </div>
                </div>
                <div>
                    <div class="item-details">
                        <a class="time" title="{item.date.readableTime()} " href="/new/{item.id}">{item.date.relativeTime(true)}</a>
                        <span class="time">von</span>
                        <a href="#user/{item.user}" class="user um{item.mark}">{item.user}</a>
                        <span class="item-source">
                    <?js if( item.source ) {?>
                            <span class="pict">s</span>&nbsp;<a href="{{item.source}}" target="_blank">{{item.source.hostName()}}</a>
                            <?js } else { ?>
                            <span class="pict">s</span>upload</span>
                        <?js } ?>
                        </span>
                        <?js if( !item.video ) {?>
                        <span class="item-google-search">
                        <span class="pict">g</span>&nbsp;
                        <a href="https://imgops.com/{item.trimmedUrl}">
                          ImgOps
                        </a> |
                        <a href="https://www.google.com/searchbyimage?hl=en&amp;safe=off&amp;site=search&amp;image_url=http:{item.image}"
                           target="_blank"> Bild googeln
                        </a> |
                        <a href="https://tineye.com/search/?url=http:{item.image}"
                           target="_blank"> tineye
                        </a>
                    </span>
                        <?js } ?>
                        <?js if( p.user.admin ) { ?>
                        [<span class="action" id="item-delete" data-id="{item.id}">del</span>]
                        [<a href="/new/phash.{item.id}.12">phash</a>]
                        <?js } ?>
                        <span class="item-report action" data-item="{item.id}"><span
                                class="fa fa-exclamation-triangle"></span></span>
                        <input type="hidden" name="deleted" id="deleted" value="{item.deleted}">
                    </div>
                    <div class="item-tags"></div>
                </div>
            </div>
        </div>
    </div>
</div>
`,ye=`<div class="comment-count">
    <div class="count"><span class="pict">c</span> {"Kommentar".inflect(commentCount)}</div>
    <div class="comments-switch fa fa-chevron-right"></div>
    <div class="comments-toggle fa fa-bars"></div>
</div>
<div class="comments-head">
    <?js if( p.user.id ) {?>
    <form class="comment-form" method="post">
        <textarea class="comment" name="comment" required
                  placeholder="Kommentar schreiben\u2026"></textarea>
        <input type="hidden" name="parentId" value="0"/>
        <input type="hidden" name="itemId" value="{params.id}"/>
        <div>
            <input type="submit" value="Abschicken"/>
            <input type="button" value="Abbrechen" class="cancel"/>
        </div>
    </form>

    <form class="comment-edit-form" method="post">
        <textarea class="comment" required name="comment"></textarea>
        <input type="hidden" name="commentId" value="0"/>
        <div>
            <input type="submit" value="Abschicken"/>
            <input type="button" value="Abbrechen" class="cancel"/>
        </div>
    </form>
    <div class="comments">
        <?js var recurseComments = function( comments, level ) { ?>
        <div class="comment-box">
            <?js for( var i = 0; i < comments.length; i++ ) { var c = comments[i]; ?>
            <div class="comment-box-inner">
                <div class="comment{p.voteClass(c.vote)}" id="comment{c.id}">
                    <div class="comment-vote">
                        <span class="pict vote-up">+</span>
                        <span class="pict vote-down">-</span>
                    </div>
                    <div class="comment-content"> {c.content.format()}</div>
                    <div class="comment-foot">
                        <?js if(c.name == itemUser){?>
                        <span class="user-comment-op">OP</span>
                        <?js}?>
                        <a href="#user/{c.name}" class="user um{c.mark}">{c.name}</a>
                        <?js if( p.shouldShowScore(c) ) {?>
                        <span class="score"
                              title="{c.up} up, {c.down} down">{"Punkt".inflect(c.score)}</span> <?js } else { ?>
                        <span class="score-hidden" title="Score noch unsichtbar">\u25CF\u25CF\u25CF</span> <?js } ?>
                        <a href="#{tab}/{itemId}:comment{c.id}" class="time permalink"
                           title="{c.date.readableTime()} ">{c.date.relativeTime(true)}</a>
                        <?js if( level < CONFIG.COMMENTS_MAX_LEVELS ) {?>
                        <a href="#{tab}/{itemId}:comment{c.id}" class="comment-reply-link action">
                            <span class="pict">r</span> antworten
                        </a>
                        <?js } ?>
                        <?js if (c.children.length > 0) {?>
                        <span class="fold fold-in action" title="Kommentare einklappen">[\u2013]</span>
                        <span class="fold fold-out action" title="Kommentare ausklappen">[+]</span>
                        <span class="folded-comments-message"> (<span class="folded-comments-count"></span> eingeklappt) </span>
                        <?js } ?>
                        <?js if( p.user.admin ) {?>
                        [ <span class="comment-delete action">del</span> /
                        <a href="#{tab}/{itemId}:comment{c.id}" class="comment-edit-link action">edit</a> ]
                        <?js } ?>
                        <span class="comment-report action" data-item="{itemId}"
                              data-comment="{c.id}"><span class="fa fa-exclamation-triangle"></span></span>

                        <?js if( c.name != p.user.name ) {?> <span
                            class="pict vote-cfav<?js if (c.fav){ ?> faved<?js } ?>">*</span> <?js } ?>
                    </div>
                </div>
                <?js if( c.children.length ) { recurseComments(c.children, level+1); } ?>
            </div>
            <?js } ?>
        </div>
        <?js }; ?>
        <?js recurseComments(comments, 1); ?>
    </div>
    <?js } ?>
</div>
`;class ke{constructor(){o(this,"id","WidescreenMode");o(this,"name","Widescreen Mode");o(this,"needsReRendering",!0);o(this,"container",{});o(this,"commentsContainer",{});o(this,"resized",!1);o(this,"listenerAdded",!1);o(this,"description","Stellt das pr0 im Breitbildmodus dar.");o(this,"displayBenis",c.get("WidescreenMode.settings.display_benis"));o(this,"closeOnBackgroundClick",c.get("WidescreenMode.settings.close_on_background"));o(this,"mouseControl",c.get("WidescreenMode.settings.mouse_control"));o(this,"displayBenisbar",c.get("WidescreenMode.settings.display_benisbar"));o(this,"scrollMultiplicator",Number(c.get("WidescreenMode.settings.scroll_speed"))||1);o(this,"displayBenisUntilTop",c.get("WidescreenMode.settings.display_benis_until_top"));o(this,"biggerStreamNavIcons",c.get("WidescreenMode.settings.bigger_stream_nav_icons"));o(this,"commentsLeft",c.get("WidescreenMode.settings.comments_left"));o(this,"logoLinksToNew",c.get("WidescreenMode.settings.logo_links_to_new"));o(this,"commentsWide",window.localStorage.getItem("comments_wide")==="true");o(this,"commentsClosed",window.localStorage.getItem("comments_closed")==="true");o(this,"comments",[]);o(this,"header",document.getElementById("head-content"));o(this,"nav",{button:null,links:null,container:document.getElementById("footer-links")});o(this,"logoLink");o(this,"moveLink");o(this,"img");o(this,"isMoveable",!1)}handleWheelChange(e){if(this.isMoveable)return this.img.animate({top:(e.deltaY>0?"-=":"+=")+20*this.scrollMultiplicator},0),!1;if(this.hasUnsentComments()&&!window.confirm("Du hast noch nicht abgeschickte Kommentare! Willst du dieses Medium wirklich verlassen?"))return!1;(e.deltaY<0?document.getElementsByClassName("stream-prev")[0]:document.getElementsByClassName("stream-next")[0]).click()}async load(){this.checkScoreDisplay(),this.addInputListeners(),this.addHeaderListener(),this.overrideViews(),this.addNavigation(),this.logoLinksToNew&&this.modifyLogo(),u(xe)}checkScoreDisplay(){this.displayBenis&&(p.shouldShowScore=()=>!0)}getSettings(){return[{id:"display_benis_until_top",title:"Benis bis beliebt anzeigen",description:"Zeigt an, wie viel Benis ungef\xE4hr bis beliebt fehlt. (Nur mit Benisleiste m\xF6glich)",type:"checkbox"},{id:"display_benis",title:"Benis sofort anzeigen",description:"Zeigt den Benis direkt ohne Wartezeit an!",type:"checkbox"},{id:"mouse_control",title:"Steuerung mit der Maus",description:"Wechsle mit dem Mausrad zwischen Medien.",type:"checkbox"},{id:"close_on_background",title:"Hintergrund schlie\xDFt",description:"Bei Klick auf Hintergrund Medium schlie\xDFen.",type:"checkbox"},{id:"display_benisbar",title:"Benisleiste anzeigen",description:"Zeigt die Benisverteilung als Leiste an.",type:"checkbox"},{id:"bigger_stream_nav_icons",title:"Post-Navigationslinks vergr\xF6\xDFern",description:"Vergr\xF6\xDFert die Links um zum n\xE4chsten/vorherigen Post zu kommen. (Nur ohne pr0mium)",type:"checkbox"},{id:"scroll_speed",title:"Scrollgeschwindigkeit",description:"Definiere, wie schnell im Zoom gescrollt werden soll.",type:"number"},{id:"comments_left",title:"Kommentare auf der linken Seite",description:"Wenn deaktiviert werden Kommentare auf der rechten Seite des Bildschirms angezeigt.",type:"checkbox"},{id:"logo_links_to_new",title:"Logo-Verlinkung auf Neu",description:"Wenn aktiviert bringt dich ein Klick auf das pr0gramm Logo nach /new statt /top.",type:"checkbox"}]}addHeaderListener(){const e=document.querySelectorAll("#head-menu > a");for(const t of e)$(t).unbind("click"),t.addEventListener("click",n=>{n.preventDefault();const i=t.getAttribute("href");if(i==null)throw new Error("Could not parse navigation link from anchor element. There is no href attribute");const s=i.startsWith("/")?i.slice(1):i;s===p.location?p.reload():p.navigateTo(s)})}addInputListeners(){this.listenerAdded||(this.listenerAdded=!0,document.addEventListener("keydown",e=>{this.handleKeypress(e,document.activeElement.tagName==="TEXTAREA"||document.activeElement.tagName==="INPUT")}),window.addEventListener("locationChange",e=>{(e.mode===0||!e.isPost)&&document.body.classList.remove("fixed")}))}modifyLogo(){const e=document.getElementById("pr0gramm-logo-link");this.logoLink=e.cloneNode(!0),e.parentNode.replaceChild(this.logoLink,e),this.logoLink.href="/new",this.logoLink.addEventListener("click",t=>{t.preventDefault(),p.location==="new"?p.reload():p.navigateTo("new",p.NAVIGATE.DEFAULT)})}overrideViews(){let e=this;p.View.Stream.Item=p.View.Stream.Item.extend({template:we,show:function(t,n,i,s,a){n.trimmedUrl=n.image.replace(/^\/\//g,""),this.parent(t,n,i,s,a),this.syncVotes(p.user.voteCache.votes);const r=document.getElementsByClassName("benisbar")[0];if(e.displayBenisbar){if(n.down>0){let m=n.up/(n.up+n.down);r.setAttribute("style",`background-image: -webkit-gradient(linear, 0% 0%, 100% 0%, from(#5cb85c), to(#888), color-stop(${m}, #5cb85c), color-stop(${m}, #888));`)}if(e.displayBenisUntilTop){const m=Date.now();Math.abs(m-n.date)/36e5<3&&n.promoted==0&&(r.dataset.afterText+=" ("+e.calculateBenisUntilTop(n.up,n.down,n.date)+" bis beliebt)")}r.classList.add("show",String(e.displayBenisbar))}if(e.addItemListener(this.$image,n),document.body.classList.add("fixed"),e.biggerStreamNavIcons){let m=document.getElementsByClassName("stream-prev-icon")[0],d=document.getElementsByClassName("stream-next-icon")[0];m!==void 0&&m.classList.add("stream-prev-icon-xl"),d!==void 0&&d.classList.add("stream-next-icon-xl")}e.commentsLeft||document.getElementsByClassName("item-container-content")[0].classList.add("right")},remove:function(){this.parent(),document.body.classList.remove("fixed")}}),x.addVideoConstants(),p.View.Stream.Comments=p.View.Stream.Comments.extend({template:ye,_commentToFocus:null,render:function(){this._commentToFocus=this.data.params.comment,this.parent(),e.commentsContainer=this.$container[0],e.comments=[this.$commentForm.find("textarea")[0]],e.commentsContainer.classList.toggle("wide",e.commentsWide),e.commentsContainer.classList.toggle("closed",e.commentsClosed),e.commentsContainer.classList.add("loaded"),this._commentToFocus&&(this.focusComment(this._commentToFocus),this._commentToFocus=null);let t=this.$container.find(".comments-switch")[0],n=this.$container.find(".comments-toggle")[0];t.addEventListener("click",()=>{e.commentsContainer.classList.toggle("wide"),e.commentsWide=e.commentsContainer.classList.contains("wide"),window.localStorage.setItem("comments_wide",String(e.commentsWide))}),n.addEventListener("click",()=>{e.commentsContainer.classList.toggle("closed"),e.commentsClosed=e.commentsContainer.classList.contains("closed"),window.localStorage.setItem("comments_closed",String(e.commentsClosed))})},focusComment:function(t){let n=this.$container.find(`#${t}`);n.length&&(n.get(0).scrollIntoView({behaviour:"smooth"}),n.highlight(180,180,180,1))},showReplyForm(t){this.parent(t);let n=t.currentTarget.href.split(":comment")[1];e.comments.push(document.querySelectorAll(`#comment${n} textarea`)[0])}}),p.View.Stream.Comments.SortConfidenceTime=t=>function(n,i){return n.confidence>=.2&&t===n.name&&t!==i.name?-1:i.confidence>=.2&&t===i.name&&t!==n.name?1:i.confidence===n.confidence?n.created-i.created:i.confidence-n.confidence},p.View.Stream.Comments.SortTime=function(t,n){return t.created-n.created},p.View.Stream.Main.prototype.buildItemRows=function(t){let n="";for(const i of t)n+=this.buildItem(i);return`<div class="stream-row">${n}</div>`}}calculateBenisUntilTop(e,t,n){return Math.ceil(7.2857*t+(n.getHours()>=22||n.getHours()<=6?15:16)-e)}addItemListener(e,t){this.img=e,this.container=this.img[0].parentNode,this.resized=t.height>this.container.offsetHeight||t.width>this.container.offsetWidth,this.container.classList.toggle("resized",this.resized),this.moveLink=document.getElementsByClassName("move-link")[0],this.resized&&(this.container.classList.add("oversize"),this.img.draggable(),this.img.draggable("disable")),this.mouseControl&&this.container.addEventListener("wheel",n=>{n.preventDefault(),this.handleWheelChange(n)}),this.moveLink&&this.moveLink.addEventListener("click",n=>{n.preventDefault(),this.toggleMove()}),this.closeOnBackgroundClick&&this.container.addEventListener("click",n=>{n.target===this.container&&(p.currentView.currentItemId=null,p.currentView.hideItem())})}handleKeypress(e,t=!1){if(t)return e.ctrlKey&&e.code==="Enter"&&$(document.activeElement).parents("form").find('input[type="submit"]')[0].click(),!0;switch(e.code){case"Space":e.preventDefault(),this.toggleMove();break;case"Escape":this.resized&&p.currentView.$itemContainer&&p.currentView.hideItem();break;case"ArrowUp":case"ArrowDown":if(this.isMoveable)this.img.animate({top:e.code==="ArrowDown"?"-=20":"+=20"},0);else{let n=this.commentsContainer.find(".scroll-content");n.is(":focus")||n.attr("tabindex",-1).focus()}break}}hasUnsentComments(){if(p.user.id){for(const e of this.comments)if(e.value!=="")return!0}return!1}toggleMove(){this.resized&&(this.img.off("click"),this.container.classList.toggle("resized"),this.isMoveable=!this.container.classList.contains("resized"),this.img.draggable(this.isMoveable?"enable":"disable"),this.img.attr("tabindex",-1).focus(),this.img.resizeInit||(this.container.style.alignItems="flex-start"),this.img.resizeInit=!0),this.isMoveable||this.img.on("click",()=>{p.currentView.hideItem()})}addNavigation(){this.nav.button=document.createElement("a"),this.nav.links=this.nav.container.querySelectorAll("a"),this.nav.button.className="fa fa-bars sidebar-toggle",this.header.insertBefore(this.nav.button,this.header.firstChild),this.nav.button.addEventListener("click",()=>{this.toggleNavigation()});for(const e of this.nav.links)e.addEventListener("click",()=>{this.toggleNavigation()});this.addMenuItem("pr0p0ll","https://pr0p0ll.com"," fa-bar-chart")}toggleNavigation(){this.nav.container.classList.toggle("open"),this.nav.button.classList.toggle("active")}addMenuItem(e,t,n){let i=document.createElement("a");i.className=n,i.innerText=e,i.href=t,i.target="_blank",this.nav.container.firstElementChild.appendChild(i)}}const Ce={StyleCustomization:()=>new ve,AdvancedComments:()=>new F,AnonymousTitle:()=>new Z,BenisInNavbar:()=>new Q,Chat:()=>new Y,DefaultFilters:()=>new ee,DesktopNotifications:()=>new te,FilterMarks:()=>new M,ImageOCR:()=>new se,Rep0st:()=>new he,RepostMarker:()=>new _,StatisticsLinkInNavbar:()=>new fe,ViewedPostsMarker:()=>new I,NotificationCenter:()=>new B,Pr0p0ll:()=>new de,WidescreenMode:()=>new ke},Le=`::-webkit-scrollbar{width:9px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background-color:#9b9b9b80;border-radius:20px;border:transparent}
`,V=Object.values(Ce).map(l=>l()),z=[],Se=()=>{const l=window.localStorage.getItem("activated_modules");if(l===null)return window.localStorage.setItem("activated_modules","[]"),c.addHint(),[];const e=JSON.parse(l);return V.filter(t=>e.includes(t.id))},Ee=l=>z.some(e=>e.id===l.id),Te=async l=>{Ee(l)||(await l.load(),z.push(l),console.debug(`Loaded module: ${l.id}`))},$e=async l=>Promise.all(l.map(e=>Te(e))),Me=()=>{let l=document.createElement("link");l.type="text/css",l.rel="stylesheet",l.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(l);let e=document.createElement("style");e.textContent=Le,document.getElementsByTagName("head")[0].appendChild(e)},j=Se();if(x.addPrototypes(),new H,new c(V,j),Me(),j.length>0){$e(j);const l=p._routes.find(t=>String(t.rule)==="/(.*)/"),e=p._routes.indexOf(l);p._routes.push(p._routes.splice(e,1)[0]),z.some(t=>t.needsReRendering)&&setTimeout(()=>{p.currentView=null,p.navigateTo(p.getURL(),p.NAVIGATE.FORCE)},0)}})(Tesseract,Chart);
